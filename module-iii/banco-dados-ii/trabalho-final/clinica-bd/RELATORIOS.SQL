
-- RELATÓRIO DE CONSULTAS REALIZADAS E AGENDADAS POR MÉDICO

SELECT M.NOME AS NOME_MEDICO, SUM(CASE WHEN C.STATUS = 'R' THEN 1 ELSE 0 END) AS 
CONSULTAS_REALIZADAS, SUM(CASE WHEN C.STATUS = 'A' THEN 1 ELSE 0 END) 
AS CONSULTAS_AGENDADAS FROM CONSULTA C JOIN MEDICO M ON C.CRM = M.CRM 
GROUP BY M.NOME ORDER BY CONSULTAS_REALIZADAS DESC;

-- RELATÓRIO DE PACIENTES INTERNADOS POR PLANO DE SAÚDE

SELECT P.NOME AS NOME_PLANO, COUNT(I.COD_INTERNA) AS PACIENTES_INTERNADOS FROM INTERNACAO I JOIN 
PLANO P ON I.COD_PLANO = P.COD_PLANO GROUP BY P.NOME ORDER BY PACIENTES_INTERNADOS DESC;

-- RELATÓRIO DE PROCEDIMENTOS REALIZADOS POR FUNCIONÁRIO

SELECT F.NOME AS NOME_FUNCIONARIO, COUNT(PR.COD_PROCED) AS PROCEDIMENTOS_REALIZADOS, 
SUM(PR.VALOR) AS VALOR_TOTAL_PROCEDIMENTOS FROM PROCEDIMENTO PR JOIN FUNCIONARIO F ON 
PR.COD_FUNC = F.COD_FUNC GROUP BY F.NOME ORDER BY VALOR_TOTAL_PROCEDIMENTOS DESC;

-- RELATÓRIO DE SUPERVISÕES MÉDICAS

SELECT SUP.NOME AS SUPERVISOR, COUNT(SUB.NOME) AS NUMERO_SUPERVISIONADOS FROM SUPERVISAO S JOIN 
MEDICO SUP ON S.COD_SUPERVISOR = SUP.CRM JOIN MEDICO SUB ON S.COD_SUPERVISIONA = SUB.CRM 
GROUP BY SUP.NOME ORDER BY NUMERO_SUPERVISIONADOS DESC;

-- RELATÓRIO DE INTERNAÇÕES CONCLUÍDAS POR TIPO DE CONCLUSÃO (ALTA OU ÓBITO)

SELECT CONCLUSAO, COUNT(COD_INTERNA) AS TOTAL_INTERNAÇÕES FROM INTERNACAO WHERE 
DT_CONCLUSAO IS NOT NULL GROUP BY CONCLUSAO;

-- RELATÓRIO DE MEDICAMENTOS PRESCRITOS POR PLANO DE SAÚDE

SELECT MED.NOME AS NOME_MEDICAMENTO, PL.NOME AS NOME_PLANO, COUNT(PM.COD_PM) AS PRESCRICOES 
FROM PM JOIN MEDICAMENTO MED ON PM.COD_MED = MED.COD_MED JOIN PLANO PL ON PM.COD_PLANO = 
PL.COD_PLANO GROUP BY MED.NOME, PL.NOME ORDER BY NOME_MEDICAMENTO, NOME_PLANO;

-- RELATÓRIO DE CARGOS E MÉDIA SALARIAL

SELECT C.NOME AS NOME_CARGO, ROUND(AVG(C.SALARIO), 2) AS MEDIA_SALARIAL FROM FUNCIONARIO F JOIN 
CARGO C ON F.COD_CARGO = C.COD_CARGO GROUP BY C.NOME ORDER BY MEDIA_SALARIAL DESC;

-- RELATÓRIO DE CONSULTAS POR DATA

SELECT DT_CONSUL AS DATA_CONSULTA, COUNT(COD_CONSUL) AS NUMERO_CONSULTAS FROM CONSULTA WHERE 
DT_CONSUL IS NOT NULL GROUP BY DT_CONSUL ORDER BY DATA_CONSULTA DESC;